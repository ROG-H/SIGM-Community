<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html> <!-- Ejemplo basico de lanzador de la aplicacion -->
  <head>
	<title>Ejemplo de firma manuscrita</title>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
	<script type="text/javascript" src="handwritten.js"></script>
	<script type="text/javascript">

		var docUrl = "http://localhost:8080/handwritten-service/formulario1.pdf";
		var storageServiceUrl = "http://localhost:8080/handwritten-service/StorageService";
		var htmlTemplate = "<html><body><img src=\"data:image/png;base64,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\">" +
			"<h1>Certifico que %SURNAME1% %SURNAME2%, %NAME%, con documento de identidad n&uacute;mero %NIF% es residente en Espa&ntilde;a</h1></body></html>";
		var x = "20";
		var y = "200";
		var width = "700";
		var height = "100";
		var publicKey = "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCPaoBx45/SnIBMQzQHEErv54YDQcRlYNmmp2EJ5W+wjUCqEtZClY2DrlMZcTyKPPEZT/JL3iT/fiA+AiSVr6n+asNo2xVjr1FwunWFZhwvrWsz/8if6FeUDepQrpqz3jZvnljLM2xslJA8I2CSIa4hBOjVd+x+ThdkOL7I1JGBQwIDAQAB";
		var keyDn = "C=ES, OU=Clase 2 persona fisica, EMAILADDRESS=test@prueba.com, SERIALNUMBER=12345678Z, SURNAME=Usuario Activo, GIVENNAME=ANF, CN=ANF Usuario Activo";
		var extraParams = "tsaURL=http://zpsis.catcert.net/psis/catcert/tsp\ntsaPolicy=0.4.0.2023.1.1\ntsaRequireCert=true\ntsaHashAlgorithm=SHA-512\n" +
		"imagePage=1\nPositionOnPageLowerLeftX=70\nPositionOnPageLowerLeftY=120\nPositionOnPageUpperRightX=160\nPositionOnPageUpperRightY=90";

		function sign() {
			try {
				var name = document.getElementById("signerName").value;
				var surname1 = document.getElementById("signerSurname1").value;
				var surname2 = document.getElementById("signerSurname2").value;
				var nif = document.getElementById("signerNif").value;
				
				Handwritten.signWithHtml(
					docUrl,
					storageServiceUrl,
					htmlTemplate.replace("%SURNAME1%", surname1.toUpperCase()).replace("%SURNAME2%", surname2.toUpperCase()).replace("%NAME%", name.toUpperCase()).replace("%NIF%", nif.toUpperCase()),
					x,
					y,
					width,
					height,
					publicKey,
					keyDn,
					name,
					surname1,
					surname2,
					nif,
					extraParams);
				
			} catch(e) {
				alert("Error: " + Handwritten.getErrorMessage());
			}
		}

	</script>
  </head>
	<body>
		<script type="text/javascript">
			Handwritten.cargarApplet('http://localhost:8080/handwritten-service');
		</script>

		 <div id="logo">
  			<img src="img/escudo_gobierno.gif">
  			<img src="img/logo_agencia.gif">
  		</div>

		<div><h1>Firma del certificado de residencia</h1></div>
		
		<fieldset><legend>Datos del ciudadano</legend>
			<div><b>Nombre y Apellidos:</b> <span>JUAN ESPA&Ntilde;OL ESPA&Ntilde;OL</span></div>
			<div><b>NIF:</b> <span>XXXXXXXXXXA</span></div>
		</fieldset>
		
		<fieldset><legend>Datos del firmante</legend>
		<div>
		 <div><span>Nombre: </span><br/>
		 	<input id="signerName" type="text">
		 </div>
		 <div><span>Apellido 1: </span><br/>
		 	<input id="signerSurname1" type="text">
		 </div>
		 <div><span>Apellido 2: </span><br/>
		 	<input id="signerSurname2" type="text">
		 </div>
		 <div><span>NIF: </span><br/>
		 	<input id="signerNif" type="text">
		 </div>

		 <input type="button" value="Firma" onclick="sign();">
		</div>
		</fieldset>

	</body>
</html>	